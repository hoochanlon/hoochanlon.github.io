(async()=>{var t="visitorData",e=document.querySelectorAll(".visitor_content");if(e.length){let s=JSON.parse(localStorage.getItem(t)||"null");if(!s||"1.1"!==s.jsVersion||864e5<Date.now()-s.timestamp){var a=(()=>{var t=navigator.userAgent.toLowerCase();let e="未知浏览器",a="未知版本";return/msie|trident/.test(t)?(e="IE",a=t.match(/(msie |rv:)([\d.]+)/)?.[2]||""):/edg/.test(t)?(e="Edge",a=t.match(/edg\/([\d.]+)/)?.[1]||""):/firefox/.test(t)?(e="Firefox",a=t.match(/firefox\/([\d.]+)/)?.[1]||""):/chrome/.test(t)?(e="Chrome",a=t.match(/chrome\/([\d.]+)/)?.[1]||""):/safari/.test(t)&&(e="Safari",a=t.match(/version\/([\d.]+)/)?.[1]||""),e+" "+a})();let o="未知",i="未知位置";try{var r=await n("https://ipapi.co/json/");o=r.ip||"未知",i=(`${r.country_name||""} `+(r.region||"")).trim()||"未知位置"}catch{}try{i=(await n(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(i)}&langpair=en|zh-CN`)).responseData.translatedText||i}catch{}s={ip:o,location:i,browser:a,timestamp:Date.now(),jsVersion:"1.1"},localStorage.setItem(t,JSON.stringify(s))}async function n(t,e=5e3){return Promise.race([fetch(t).then(t=>t.json()),new Promise((t,a)=>setTimeout(()=>a(new Error("timeout")),e))])}e.forEach(t=>{t.innerHTML=`\n      欢迎来自 <span class="p">${s.location}</span> 的朋友 🎉<br>\n      IP：<span class="p">${s.ip}</span><br>\n      浏览器：<span class="p">${s.browser}</span>\n    `})}})();