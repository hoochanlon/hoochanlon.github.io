!async function(){const t="visitorData",e=document.querySelectorAll(".visitor_content");if(!e.length)return;async function n(t,e=5e3){return Promise.race([fetch(t).then(t=>t.json()),new Promise((t,n)=>setTimeout(()=>n(new Error("timeout")),e))])}let a=JSON.parse(localStorage.getItem(t)||"null");if(!a||"1.1"!==a.jsVersion||Date.now()-a.timestamp>864e5){const e=function(){const t=navigator.userAgent.toLowerCase();let e="未知浏览器",n="未知版本";return/msie|trident/.test(t)?(e="IE",n=t.match(/(msie |rv:)([\d.]+)/)?.[2]||""):/edg/.test(t)?(e="Edge",n=t.match(/edg\/([\d.]+)/)?.[1]||""):/firefox/.test(t)?(e="Firefox",n=t.match(/firefox\/([\d.]+)/)?.[1]||""):/chrome/.test(t)?(e="Chrome",n=t.match(/chrome\/([\d.]+)/)?.[1]||""):/safari/.test(t)&&(e="Safari",n=t.match(/version\/([\d.]+)/)?.[1]||""),`${e} ${n}`}();let r="未知",s="未知位置";try{const t=await n("https://ipapi.co/json/");r=t.ip||"未知",s=`${t.country_name||""} ${t.region||""}`.trim()||"未知位置"}catch{}try{s=(await n(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(s)}&langpair=en|zh-CN`)).responseData.translatedText||s}catch{}a={ip:r,location:s,browser:e,timestamp:Date.now(),jsVersion:"1.1"},localStorage.setItem(t,JSON.stringify(a))}e.forEach(t=>{t.innerHTML=`\n      欢迎来自 <span class="p">${a.location}</span> 的朋友 🎉<br>\n      IP：<span class="p">${a.ip}</span><br>\n      浏览器：<span class="p">${a.browser}</span>\n    `})}();