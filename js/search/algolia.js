window.addEventListener("load",()=>{const{algolia:t}=GLOBAL_CONFIG,{appId:i,apiKey:e,indexName:a,hitsPerPage:n=5,languages:s}=t;if(!i||!e||!a)return console.error("Algolia setting is invalid!");const l=document.getElementById("search-mask"),o=document.querySelector("#algolia-search .search-dialog"),r=t=>{const i=t?"animateIn":"animateOut",e=t?"to_show 0.5s":"to_hide 0.5s",a=t?"titleScale 0.5s":"search_close .5s";btf[i](l,e),btf[i](o,a)},c=()=>{window.innerWidth<768&&o.style.setProperty("--search-height",`${window.innerHeight}px`)},g=()=>{btf.overflowPaddingR.add(),r(!0),y(!1),setTimeout(()=>{const t=document.querySelector("#algolia-search-input .ais-SearchBox-input");t&&t.focus()},100);const t=i=>{"Escape"===i.code&&(d(),document.removeEventListener("keydown",t))};document.addEventListener("keydown",t),c(),window.addEventListener("resize",c)},d=()=>{btf.overflowPaddingR.remove(),r(!1),window.removeEventListener("resize",c)},p=()=>{btf.addEventListenerPjax(document.querySelector("#search-button > .search"),"click",g)},h=t=>{if(!t)return"";let i="";if("string"==typeof t)i=t.trim();else if("object"==typeof t)if(void 0!==t.value){if(i=String(t.value).trim(),!i)return""}else{if(t.matchedWords||t.matchLevel||void 0!==t.fullyHighlighted)return"";try{if(i=JSON.stringify(t).trim(),"{}"===i||"[]"===i||'""'===i)return""}catch(t){return""}}else{if(!t.toString||"function"!=typeof t.toString)return"";if(i=t.toString().trim(),"[object Object]"===i||"[object Array]"===i)return""}const e=i.indexOf("<mark>");let a=e-30,n=e+120,s="",l="";a<=0?(a=0,n=140):s="...",n>i.length?n=i.length:l="...";let o=i.substring(a,n);const r=o.indexOf(">"),c=o.indexOf("<");-1!==r&&(-1===c||r<c)&&(o=o.substring(r+1));const g=o.lastIndexOf("<"),d=o.lastIndexOf(">");-1!==g&&g>d&&(o=o.substring(0,g));const p=[];let h="",u=0;for(;u<o.length;){if("<"===o[u])if("/"===o[u+1]){const t=o.indexOf(">",u);if(-1!==t){const i=o.substring(u+2,t);for(let t=p.length-1;t>=0;t--)if(p[t]===i){p.splice(t,1);break}h+=o.substring(u,t+1),u=t+1;continue}}else if("<!"===o.substr(u,2)||-1!==o.indexOf("/>",u)&&o.indexOf("/>",u)<o.indexOf(">",u)){const t=o.indexOf(">",u);if(-1!==t){h+=o.substring(u,t+1),u=t+1;continue}}else{const t=o.indexOf(">",u);if(-1!==t){const i=o.substring(u+1,o.indexOf(" ",u)>-1&&o.indexOf(" ",u)<t?o.indexOf(" ",u):t).split(/\s/)[0];p.push(i),h+=o.substring(u,t+1),u=t+1;continue}}h+=o[u],u++}for(;p.length>0;){h+=`</${p.pop()}>`}if(a>0||s){const t=i.indexOf("<",a>0?a-30:0),e=i.indexOf("<mark>",a>0?a-30:0);-1!==t&&(-1===e||t<e)&&(s="...")}return o=h,`${s}${o}${l}`},u=t=>t?"string"==typeof t?t.trim():"object"==typeof t&&void 0!==t.value?String(t.value).trim():"":"";let f;if(window["algoliasearch/lite"]&&"function"==typeof window["algoliasearch/lite"].liteClient)f=window["algoliasearch/lite"].liteClient(i,e);else{if("function"!=typeof window.algoliasearch)return console.error("Algolia search client not found!");f=window.algoliasearch(i,e)}if(!f)return console.error("Failed to initialize Algolia search client");let m="";const y=t=>{const i=document.getElementById("loading-status");i&&(i.hidden=!t)},P={get searchInput(){return document.querySelector("#algolia-search-input .ais-SearchBox-input")},get hits(){return document.getElementById("algolia-hits")},get hitsEmpty(){return document.getElementById("algolia-hits-empty")},get hitsList(){return document.querySelector("#algolia-hits .ais-Hits-list")},get hitsWrapper(){return document.querySelector("#algolia-hits .ais-Hits")},get pagination(){return document.getElementById("algolia-pagination")},get paginationList(){return document.querySelector("#algolia-pagination .ais-Pagination-list")},get stats(){return document.querySelector("#algolia-info .ais-Stats-text")}},b=t=>{P.pagination.style.display=t?"":"none",P.stats.style.display=t?"":"none"},v=(t,i,e=0)=>{if(0===t.length&&i)return P.hitsEmpty.textContent=s.hits_empty.replace(/\$\{query}/,i),P.hitsEmpty.style.display="",P.hitsWrapper.style.display="none",void(P.stats.style.display="none");P.hitsEmpty.style.display="none";const a=t.map((t,i)=>{const a=e*n+i+1,s=t.permalink||GLOBAL_CONFIG.root+t.path,l=t._highlightResult||t;let o="";try{l.contentStripTruncate?o=h(l.contentStripTruncate):l.contentStrip?o=h(l.contentStrip):l.content?o=h(l.content):t.contentStripTruncate?o=h(t.contentStripTruncate):t.contentStrip?o=h(t.contentStrip):t.content&&(o=h(t.content))}catch(t){o=""}let r="no-title";try{l.title?r=u(l.title)||"no-title":t.title&&(r=u(t.title)||"no-title"),r&&"no-title"!==r||(r="string"==typeof t.title&&t.title.trim()?t.title.trim():t.title&&"object"==typeof t.title&&t.title.value&&String(t.title.value).trim()||"no-title")}catch(t){r="no-title"}return`\n        <li class="ais-Hits-item" value="${a}">\n          <a href="${s}" class="algolia-hit-item-link">\n            <span class="algolia-hits-item-title">${r}</span>\n            ${o?`<div class="algolia-hit-item-content">${o}</div>`:""}\n          </a>\n        </li>`}).join("");P.hitsList.innerHTML=a,P.hitsWrapper.style.display=i?"":"none",t.length>0&&(P.stats.style.display="")},w=(t,i)=>{if(i<=1)return P.pagination.style.display="none",void(P.paginationList.innerHTML="");P.pagination.style.display="block";const e=0===t,a=t===i-1,n=window.innerWidth<768?3:5;let s=Math.max(0,t-Math.floor(n/2));const l=Math.min(i-1,s+n-1);l-s+1<n&&(s=Math.max(0,l-n+1));let o="";i>n&&s>0&&(o+='\n        <li class="ais-Pagination-item ais-Pagination-item--page">\n          <a class="ais-Pagination-link" aria-label="Page 1" href="#" data-page="0">1</a>\n        </li>',s>1&&(o+='\n          <li class="ais-Pagination-item ais-Pagination-item--ellipsis">\n            <span class="ais-Pagination-link">...</span>\n          </li>'));for(let i=s;i<=l;i++){o+=i===t?`\n          <li class="ais-Pagination-item ais-Pagination-item--page ais-Pagination-item--selected">\n            <span class="ais-Pagination-link" aria-label="Page ${i+1}">${i+1}</span>\n          </li>`:`\n          <li class="ais-Pagination-item ais-Pagination-item--page">\n            <a class="ais-Pagination-link" aria-label="Page ${i+1}" href="#" data-page="${i}">${i+1}</a>\n          </li>`}i>n&&l<i-1&&(l<i-2&&(o+='\n          <li class="ais-Pagination-item ais-Pagination-item--ellipsis">\n            <span class="ais-Pagination-link">...</span>\n          </li>'),o+=`\n        <li class="ais-Pagination-item ais-Pagination-item--page">\n          <a class="ais-Pagination-link" aria-label="Page ${i}" href="#" data-page="${i-1}">${i}</a>\n        </li>`),i>1?(P.paginationList.innerHTML=`\n            <li class="ais-Pagination-item ais-Pagination-item--previousPage ${e?"ais-Pagination-item--disabled":""}">\n              ${e?'<span class="ais-Pagination-link ais-Pagination-link--disabled" aria-label="Previous Page"><i class="fas fa-angle-left"></i></span>':`<a class="ais-Pagination-link" aria-label="Previous Page" href="#" data-page="${t-1}"><i class="fas fa-angle-left"></i></a>`}\n            </li>\n            ${o}\n            <li class="ais-Pagination-item ais-Pagination-item--nextPage ${a?"ais-Pagination-item--disabled":""}">\n              ${a?'<span class="ais-Pagination-link ais-Pagination-link--disabled" aria-label="Next Page"><i class="fas fa-angle-right"></i></span>':`<a class="ais-Pagination-link" aria-label="Next Page" href="#" data-page="${t+1}"><i class="fas fa-angle-right"></i></a>`}\n            </li>`,P.pagination.style.display=m?"":"none"):P.pagination.style.display="none"},x=(t,i,e)=>{if(e){const e=s.hits_stats.replace(/\$\{hits}/,t).replace(/\$\{time}/,i);P.stats.innerHTML=`<hr>${e}`,P.stats.style.display=""}else P.stats.style.display="none"},S=async(t,i=0)=>{if(!t.trim())return m="",v([],"",0),w(0,0),x(0,0,""),void b(!1);y(!0),m=t;try{let e;if(f&&"function"==typeof f.search){e=(await f.search([{indexName:a,query:t,params:{page:i,hitsPerPage:n,highlightPreTag:"<mark>",highlightPostTag:"</mark>",attributesToHighlight:["title","content","contentStrip","contentStripTruncate"]}}])).results[0]}else{if(!f||"function"!=typeof f.initIndex)throw new Error("Algolia: No compatible search method available");{const s=f.initIndex(a);e=await s.search(t,{page:i,hitsPerPage:n,highlightPreTag:"<mark>",highlightPostTag:"</mark>",attributesToHighlight:["title","content","contentStrip","contentStripTruncate"]})}}v(e.hits||[],t,i);const s=e.nbHits<=n?1:e.nbPages||0;w(i,s),x(e.nbHits||0,e.processingTimeMS||0,t);const l=e.hits&&e.hits.length>0;b(l),window.pjax&&window.pjax.refresh(document.getElementById("algolia-hits"))}catch(e){console.error("Algolia search error:",e),v([],t,i),w(0,0),x(0,0,t)}finally{y(!1)}};let k;(()=>{y(!1),P.searchInput&&P.searchInput.addEventListener("input",t=>{((t,i=300)=>{clearTimeout(k),k=setTimeout(()=>S(t),i)})(t.target.value)});const t=document.querySelector("#algolia-search-input .ais-SearchBox-form");t&&t.addEventListener("submit",t=>{t.preventDefault();const i=P.searchInput.value;S(i)}),P.pagination.addEventListener("click",t=>{t.preventDefault();const i=t.target.closest("a[data-page]");if(i){const t=parseInt(i.dataset.page,10);!isNaN(t)&&m&&S(m,t)}}),b(!1)})(),p(),l.addEventListener("click",d),document.querySelector("#algolia-search .search-close-button").addEventListener("click",d),window.addEventListener("pjax:complete",()=>{btf.isHidden(l)||d(),p()})});